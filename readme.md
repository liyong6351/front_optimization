<!-- TOC -->

- [概览](#概览)
    - [1 减少Http请求](#1-减少http请求)
        - [1.1 使用图片地图](#11-使用图片地图)
        - [1.2 CSS Sprites](#12-css-sprites)
        - [1.3 内联图片](#13-内联图片)
        - [1.4 合并脚本和样式表](#14-合并脚本和样式表)
    - [2 使用CDN](#2-使用cdn)
    - [3 添加Expires头](#3-添加expires头)
        - [3.1 Expires头](#31-expires头)
        - [3.2 Max-Age和mod_expires](#32-max-age和mod_expires)
        - [3.3 空缓存VS完整缓存](#33-空缓存vs完整缓存)
        - [3.4 修订文件名](#34-修订文件名)
    - [4 压缩组件](#4-压缩组件)
        - [4.1 压缩是如何工作的](#41-压缩是如何工作的)
        - [4.2 压缩什么](#42-压缩什么)
        - [4.3 节省的数据量](#43-节省的数据量)
        - [4.4 配置](#44-配置)
        - [4.5 代理缓存](#45-代理缓存)
    - [5 将样式表放在顶部](#5-将样式表放在顶部)
    - [6 将脚本放在底部](#6-将脚本放在底部)
    - [7 避免CSS表达式](#7-避免css表达式)
    - [8 使用外部JS和CSS](#8-使用外部js和css)
    - [9 减少DNS查找](#9-减少dns查找)
    - [10 精简JS](#10-精简js)
    - [11 避免重定向](#11-避免重定向)
    - [12 移除重复脚本](#12-移除重复脚本)
    - [13 配置ETag](#13-配置etag)
    - [14 使Ajax可缓存](#14-使ajax可缓存)
    - [15 解析十大网站](#15-解析十大网站)

<!-- /TOC -->

# 概览

前端解析HTML时间其实只占到整个页面渲染的10%到20%，那么其余的时间都干什么去了~？我们能怎么去优化呢?
上述问题就是黄金法则问题

## 1 减少Http请求

### 1.1 使用图片地图

通过图片合并操作减少Http请求

### 1.2 CSS Sprites

1. 优点
* 大大的减少Http请求，提高性能
* 减少网络传输的总量

2. 缺点
* 前端处理时需要考虑布局的问题
* CSS合并不叫繁琐
* 后期维护比较麻烦，添加或者删除图表都要做CSS的修改

3. 缺点

### 1.3 内联图片

1. 优点
* 减少Http请求
* 提高性能

2. 缺点
* 浏览器不会缓存图片
* 只支持IE8以上的浏览器
* 超过100K，加载速度会变慢

### 1.4 合并脚本和样式表

<pre>
    建议JS脚本和CSS脚本分别不同的合并
</pre>

## 2 使用CDN

通过拉近用户请求和服务器之间的距离减少网络传输时间。

## 3 添加Expires头

通过缓存数据减少Http请求

### 3.1 Expires头

浏览器使用缓存减少HTTP请求的数量，并减少Http响应的大小，使Web页面加载得更快。
Expires告诉浏览器，在这一日期/时间之前，响应可以使用缓存数据

缺点:过期时间需要客户端和服务端的时钟要一致，不然就会导致超时使用的问题

### 3.2 Max-Age和mod_expires

克服了expires头的限制，他指定能缓存多久，以秒为单位定义更新窗口

mod_expires apache模块使你的使用Expires头时能够像max-age一样以相对的方式设置日期。这是通过expires_default指令来完成的。

<pre>
    <FilesMatch ".(gif|jpg|css)$">
        ExpiresDefault "access plus 10 years"
    </FilesMatch>
</pre>

### 3.3 空缓存VS完整缓存

完整缓存可以很大情况下可以改善用户体验，建议能够使用的话尽量使用缓存技术

### 3.4 修订文件名

缓存的问题在于如果有新的数据发布时，不能及时的获取到新的组件。那么在这个情况下，可以通过修改所有的链接来实现全新的数据都从最新的服务器下载

## 4 压缩组件

减少Http响应的大小来减少响应时间。

### 4.1 压缩是如何工作的

减少文件体积的文件压缩已经在Email和Ftp站点中使用了很多年了，这项技术也可以用于想浏览器发布压缩的web页面。在Http 1.1 开始，Web客户端可以通过Http请求中的Accept-Encoding头来标识对压缩的支持。gzip是最流行的压缩方法
<pre>
Accept-Encoding: gzip,defate
</pre>
Web服务器需要通过在响应中Content-Encoding: gzip来通知客户端使用解压的模式解析返回参数

### 4.2 压缩什么

<pre>
压缩一般针对CSS文件和JS文件，对于图片和Flash就不必压缩数据。  
压缩也是有成本的，选择压缩的返回格式，需要CPU时间片压缩，客户端需要CPU时间解压。所以选择压缩的方案的时候需要评估收益是否大于开销
经验值为1K，可以通过参数mod_gzip_minimum_file_size控制希望压缩的文件的最小值。默认是500B
</pre>

### 4.3 节省的数据量

一般压缩之后网络传输的数据会节省50%以上

### 4.4 配置

略

### 4.5 代理缓存

## 5 将样式表放在顶部

## 6 将脚本放在底部

## 7 避免CSS表达式

## 8 使用外部JS和CSS

## 9 减少DNS查找

## 10 精简JS

## 11 避免重定向

## 12 移除重复脚本

## 13 配置ETag

## 14 使Ajax可缓存

## 15 解析十大网站